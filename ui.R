shinyUI(dashboardPage(
  dashboardHeader(title = "Meteor Data Analysis"),
  dashboardSidebar(
    sidebarMenu(
      menuItem("Overview",
               tabName = "overview",
               icon = icon("info")),
      menuItem("Meteor Classes",
               tabName = "classes",
               icon = icon("bar-chart")),
      menuItem("Potential Impacts",
               tabName = "impacts",
               icon = icon("exclamation-triangle"))
      )
    ),
  dashboardBody(
    tabItems(
      tabItem(tabName = "overview",
              fluidPage(tabBox(id = 'tabset5', width = 12,
                tabPanel("Base Information",
                               fluidRow(box(tags$div(
                                 'There are over 700,000 comets and asteroids (meteors) that have been
                                 identified, classified and catalogued by NASA in open databases. This work
                                 is in part an attempt to make these databases accessible to more people.',
                                 tags$br(),
                                 tags$br(),
                                 'Meteors are mainly classified by the perihelion distance and
                                 semi-major axis of their orbit. As seen in the class-specific
                                 plots, this classification is artificial and can lead to
                                 truncated distributions of orbital parameters.',
                                 tags$br(),
                                 'Two distint datasets were used for this project:',
                                 tags$br(),
                                 tags$b('1. Small body object database'),
                                 tags$ul(
                                   tags$li('a) Contains info on all observed asteroids and 
                                           comets in the solar system'),
                                   tags$li('b) Focuses on orbital parameters and classification info')),
                                 tags$br(),
                                 tags$b('2. Sentry potential impact detection database'),
                                 tags$ul(
                                   tags$li('a) Contains info on only NEOs that could impact Earth'),
                                   tags$li('b) Does not have detailed orbit info'),
                                   tags$li('c) Provides info on probability of impact, velocity,
                                           estimated year range of impact')),
                                 'By combining these datasets, we gain an understanding of potential risk
                                 due to meteor impact. Included is an interactive application for plausible
                                 impacts that calculates potential crater depth and radius.'
                               ), width = 12)),
                
                fluidRow(box(imageOutput("orbital_parameters"), width = 8, height = 220),
                         box(plotlyOutput("inner_orbits"), width = 4, height = 220)),
                
                fluidRow(box(plotlyOutput("total_diameter_plot"),
                               title = tags$div(
                                 'Diameter of Meteor (km) v.', 
                                 tags$br(),
                                 'Observed Distance from Sun (AU, calculated)'),
                               status = 'primary',
                               solidHeader = TRUE,
                               width = 6),
                         box(plotlyOutput("kepler_plot"),
                               title = tags$div('Kepler\'s Third Law', tags$br(),
                                                'Orbital Period (y) v. Semi-Major Axis (AU)'),
                               status = 'primary',
                               solidHeader = TRUE,
                               width = 6)
                         )
                ),
                tabPanel("Meteor infographic",
                         fluidRow(box(h2("Infographic from the American Meteor Society"), width = 12, align = 'center')),
                         fluidRow(box(imageOutput("meteor_image"), width = 12, height = 1000))
                )
              ))),

      tabItem(tabName = "classes",
              fluidPage(tabBox(id = "tabset1", width = 12,
                       tabPanel("Class descriptions and statistics",
                         fluidRow(
                           box(tags$div(selectizeInput(inputId = "meteor_class", 
                                              label = "Meteor Class",
                                              choices = meteor_descriptions[order(meteor_classes),1], 
                                              selected = 'APO'), 
                                        tags$b('Legend for orbit schematic'),
                                        tags$br(),
                                        tags$span(style="color:blue", 'Earth'),
                                        tags$br(),
                                        tags$span(style="color:red", 'Mars'),
                                        tags$br(),
                                        tags$span(style="color:purple", 'Jupiter')),
                           width = 2, height = 210),
                           
                           #Orbit plot
                           box(plotlyOutput("single_class_orbits"),
                               width = 3, height = 210),
                           
                           #Class descriptions
                           box(htmlOutput("class_description"),
                               h6('(from Wikipedia)'),
                               width = 7, height = 210)
                          ),
                          
                         # characteristic plots of 'a' and 'q', and 'd' counts
                           fluidRow(box(plotlyOutput("characteristic_plot_a"),
                                      title = tags$div('Semi-major axis (a)',
                                                       tags$br(),
                                                       textOutput('class_label_a')),
                                      status = 'primary',
                                      solidHeader = TRUE,
                                      width = 4, align = 'center'),
                                 box(plotlyOutput("characteristic_plot_q"),
                                     title = tags$div('Perihelion distance (q)',
                                                      tags$br(),
                                                      textOutput('class_label_q')),
                                     status = 'success',
                                     solidHeader = TRUE,
                                     width = 4),
                                 box(plotlyOutput("diameter_plot"),
                                     title = tags$div('Diameter (d)',
                                                      tags$br(),
                                                      textOutput('class_label_d')),
                                     status = 'danger',
                                     solidHeader = TRUE,
                                     width = 4)),
                         fluidRow(box('The semi-major axis (a) is the longer
                                      of the two radii that define
                                      an ellipse.',
                                      width = 4, height = 150),
                                  box('The perihelion distance (q) is the point on
                                      the orbit closest to the Sun. The closer
                                      that the perihelion is to the semi-major axis,
                                      the more circular the orbit.',
                                      width = 4, height = 150),
                                  box('The diameter (d) is an estimated quantity
                                      based on other more readily measureable
                                      parameters. Specifically, it is calculated
                                      from the albedo (a, reflectance) and absolute
                                      magnitude (H, intensity).',
                                      width = 4, height = 150))
                       ),
                       tabPanel("Data and Information",
                                fluidRow(
                                  box(tags$div(
                                    tags$b("Selected data from all non-MBA objects"), 
                                    tags$br(),
                                    "Source: ", tags$html(
                                      tags$body(a('JPL Solar System Dynamics',
                                        href="https://ssd.jpl.nasa.gov/")))
                                  ), width = 12, align = 'center')
                                ),
                                fluidRow(
                                  column(12, dataTableOutput('small_body_dt'))
                                ))
                       ))),
                         

      tabItem(tabName = "impacts",
              fluidPage(tabBox(id = "tabset1", width = 12,
                               tabPanel("Crater Application",
                                        fluidRow(
                                          box(leafletOutput("crater_map"), width = 12)
                                        ),
                                        fluidRow(
                                          box(selectizeInput(inputId = "target_material", 
                                                             label = "Target material",
                                                             choices = materials$name, 
                                                             selected = "soft rock"), width = 3, height = 100),
                                          box(selectizeInput(inputId = "meteor_material",
                                                             label = "Meteor material (g/cm^3)",
                                                             choices = impactor$name,
                                                             selected = "c-type (1.8)"), width = 3, height = 100),
                                          box(selectizeInput(inputId = "city",
                                                             label = "Impact city",
                                                             choices = city_dt$name,
                                                             selected = "New York"), width = 2, height = 100),
                                          box(selectizeInput(inputId = "crater_name",
                                                             label = "Meteor name",
                                                             choices = small_body_join$Object.Designation..,
                                                             selected = "1950 DA"), width = 2, height = 100),
                                          box(sliderInput(inputId = "theta_in",
                                                          label = "Angle of Impact",
                                                          min = 10,
                                                          max = 90,
                                                          value = 60,
                                                          step = 5), width = 2, height = 100)
                                          ),
                                        fluidRow(
                                          tags$head(tags$style(HTML(".small-box {height: 150px}"))),
                                          valueBoxOutput("valuebox1", width = 2),
                                          valueBoxOutput("valuebox2", width = 2),
                                          valueBoxOutput("valuebox3", width = 2),
                                          valueBoxOutput("valuebox4", width = 2),
                                          valueBoxOutput("valuebox5", width = 2),
                                          valueBoxOutput("valuebox6", width = 2)
                                          )
                                        ),
                               tabPanel("Potentially Hazardous Object Statitics",
                                        fluidRow(
                                          box(plotlyOutput("hazard_a"), 
                                              width = 4,
                                              status = 'primary'),
                                          box(plotlyOutput("hazard_q"), 
                                              width = 4,
                                              status = 'success'),
                                          box(plotlyOutput("hazard_d"), 
                                              width = 4,
                                              status = 'danger')
                                          ),
                                        fluidRow(box(plotlyOutput("hazard_prob"), width = 12))
                                        ),
                               tabPanel("Data and Information",
                                        fluidRow(
                                          box(tags$div(
                                            tags$b("Selected data from all potentially hazardous NEOs"), 
                                            tags$br(),
                                            "Source: ", tags$html(
                                              tags$body(a('JPL Sentry - Earth Impact Monitoring',
                                                          href="https://cneos.jpl.nasa.gov/sentry/")))
                                          ), width = 12, align = 'center')
                                        ),
                                        fluidRow(
                                          column(12, dataTableOutput('small_body_join'))
                                        ))
                               
                               )
              )
      )
    )
  )
))
